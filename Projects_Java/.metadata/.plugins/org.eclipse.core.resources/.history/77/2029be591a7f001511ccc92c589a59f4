package my_pack;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Scanner;




public class Main {
	
	public static void main(String[] args){
		List<String> currently_loged_users = new ArrayList<String>();
		Map <String, Integer> mapper = new HashMap<String, Integer>(); 
	
		final Scanner in = new Scanner(System.in);
		
		while(true){
			System.out.println("Username:command");
			final String name = in.next();
			String[] full_string = name.split(":");
			if(!(full_string.length > 1)){
				System.out.println("Invalid input");
				continue;
			}
			//System.out.println(full_string[0] + " " + full_string[1] + " some_text");
			
			if(full_string[1].equals("shutdown")){
				break;
			}
			
			//add to hashmap
			if(mapper.containsKey(full_string[0])){
				int value = mapper.get(full_string[0]);
				mapper.put(full_string[0], value+1);
			} else {
				mapper.put(full_string[0], 1);
			}
			
			//for (Entry<String, Integer> entry : mapper.entrySet()) {
			  //  System.out.println(entry);
			//}
			if(full_string[1].equals("login")){
				System.out.println("ok");
				currently_loged_users.add(full_string[0]);
				continue;
			}
			if(full_string[1].equals("logout")){
				if(currently_loged_users.contains(full_string[0])){
					System.out.println("ok");
					currently_loged_users.remove(full_string[0]);
					continue;
				}
				System.out.println("error:notlogged");
				continue;
			}
			if( (full_string[1].equals("info"))&& (full_string.length == 3) ){
				//System.out.println("Stuff works!");
				if(currently_loged_users.contains(full_string[0])){
					String myString = "ok:" + full_string[2];
					if(currently_loged_users.contains(full_string[2])){
						myString += ":true";
						int val = mapper.get(full_string[2]);
						myString += val;
					} else {
						myString += ":false";
						int val = mapper.get(full_string[2]);
						myString += val;
					}
					System.out.println(myString);
				}
			} else {
				System.out.println("Not enough arguments for command info or error:notlogged");
			}
			
			if(full_string[1].equals("listavailable")){
				System.out.print("ok");
				for (String element : currently_loged_users) {
					System.out.print(":"+element);
				}
			}
		}
		
		
		in.close();
		
		System.out.println("You have exited my little applet!");
	}
	
	
			
}
